<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>–†–æ–º–ê—Ä–µ–Ω–¥–∞ ‚Äî –∞—Ä–µ–Ω–¥–∞ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
:root {
  --main-yellow: #FFC107;
  --main-black: #1F1F1F;
  --light-gray: #F3F3F3;
  --white: #FFFFFF;
}

/* –û–±—â–∏–µ —Å—Ç–∏–ª–∏ */
body { margin:0; font-family: Arial, sans-serif; background: var(--light-gray); color: var(--main-black);}
a{text-decoration:none;}
header {background: var(--main-black); color: var(--white); padding:15px 10px; text-align:center;}
header .logo-container{display:flex; align-items:center; justify-content:center; gap:12px; flex-wrap:wrap;}
header img{height:60px; border-radius:8px; object-fit:contain; transition:0.3s;}
header img:hover{transform:scale(1.1);}
header h1, header p{margin:0;}
header p{font-size:14px;}

/* –ö–æ–Ω—Ç—Ä–æ–ª—ã —Ñ–∏–ª—å—Ç—Ä–æ–≤ */
.controls {display:flex; flex-wrap:wrap; gap:8px; justify-content:center; padding:12px; background: var(--white); box-shadow:0 2px 4px rgba(0,0,0,0.1); position:sticky; top:0; z-index:200;}
input, select {padding:8px; border-radius:6px; border:1px solid #ccc; font-size:14px; transition:0.2s;}
input:focus, select:focus{border-color:var(--main-yellow); outline:none;}
label {font-size:14px; display:flex; align-items:center; gap:4px;}

/* –ö–∞—Ä—Ç–æ—á–∫–∏ —Ç–æ–≤–∞—Ä–æ–≤ */
.container {display:grid; grid-template-columns: repeat(auto-fill,minmax(260px,1fr)); gap:20px; padding:20px;}
.card {background: var(--white); border-radius:12px; box-shadow:0 2px 5px rgba(0,0,0,0.15); padding:10px; display:flex; flex-direction:column; transition:transform 0.3s, box-shadow 0.3s; cursor:pointer; overflow:hidden; opacity:0; animation:fadeIn 0.5s forwards;}
.card:hover{transform:translateY(-5px); box-shadow:0 8px 15px rgba(0,0,0,0.2);}
.card img{width:100%; height:180px; object-fit:cover; border-radius:10px; transition:0.3s;}
.card img:hover{transform:scale(1.05);}
.badge {padding:4px 8px; border-radius:6px; color:var(--main-black); font-size:12px; width:fit-content; margin-bottom:5px; font-weight:bold;}
.yes {background: var(--main-yellow);}
.no {background:#dc2626;}
.price {font-weight:bold; margin-top:5px;}
.card button {margin-top:6px; color:var(--main-black); padding:8px; border:none; border-radius:8px; font-size:14px; cursor:pointer; transition:0.3s;}
.card button:hover{transform:scale(1.05); box-shadow:0 4px 10px rgba(0,0,0,0.25);}
.cartBtn{background:var(--main-yellow); color:var(--main-black); font-weight:bold;}
.card a button{background:var(--main-yellow); font-weight:bold;}

/* –ü–æ–¥—Ä–æ–±–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ */
.card-details {max-height:0; overflow:hidden; transition:max-height 0.5s ease, padding 0.5s ease;}
.card.open .card-details{max-height:200px; padding-top:10px;}

/* –ö–æ—Ä–∑–∏–Ω–∞ */
#cartBox {position:fixed; inset:0; background:rgba(0,0,0,0.6); display:none; justify-content:center; align-items:center; z-index:999;}
#cart {background:var(--white); padding:20px; border-radius:12px; width:90%; max-width:400px; max-height:90%; overflow-y:auto; box-shadow:0 4px 15px rgba(0,0,0,0.25);}
#cart h3{margin-top:0;}
.cartItem{border-bottom:1px solid #ddd; padding:6px 0; font-size:14px;}

/* Sticky –∫–Ω–æ–ø–∫–∞ –∞—Ä–µ–Ω–¥—ã */
.sticky-order-btn{position:fixed; bottom:15px; left:50%; transform:translateX(-50%); background:var(--main-yellow); padding:12px 20px; border-radius:8px; font-weight:bold; z-index:300; cursor:pointer; box-shadow:0 4px 10px rgba(0,0,0,0.25); transition:0.3s;}
.sticky-order-btn:hover{transform:translateX(-50%) scale(1.05);}

/* –ê–Ω–∏–º–∞—Ü–∏—è –ø–æ—è–≤–ª–µ–Ω–∏—è */
@keyframes fadeIn{from{opacity:0; transform:translateY(10px);} to{opacity:1; transform:translateY(0);}}

/* –ê–¥–∞–ø—Ç–∏–≤ */
@media(max-width:600px){.card img{height:150px;} .controls{flex-direction:column; gap:6px;}}
</style>
</head>
<body>

<header>
  <div class="logo-container">
    <img src="logo.png" alt="–†–æ–º–ê—Ä–µ–Ω–¥–∞">
    <div>
      <h1>–†–æ–º–ê—Ä–µ–Ω–¥–∞</h1>
      <p>üìû +7 915 277 24 41</p>
    </div>
  </div>
</header>

<div class="controls">
  <input id="search" placeholder="–ü–æ–∏—Å–∫ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é">
  <select id="categoryFilter"><option value="all">–í—Å–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</option></select>
  <label><input type="checkbox" id="availableOnly"> –í –Ω–∞–ª–∏—á–∏–∏</label>
  <select id="sortPrice">
    <option value="none">–ë–µ–∑ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏</option>
    <option value="asc">–¶–µ–Ω–∞ ‚Üë</option>
    <option value="desc">–¶–µ–Ω–∞ ‚Üì</option>
  </select>
  <button class="cartBtn" onclick="openCart()">–ö–æ—Ä–∑–∏–Ω–∞ (<span id="cartCount">0</span>)</button>
</div>

<div class="container" id="products"></div>

<div id="cartBox">
  <div id="cart">
    <h3>–ö–æ—Ä–∑–∏–Ω–∞</h3>
    <div id="cartItems"></div>
    <input id="clientName" placeholder="–í–∞—à–µ –∏–º—è"><br><br>
    <input id="clientPhone" placeholder="–¢–µ–ª–µ—Ñ–æ–Ω"><br><br>
    <button onclick="sendOrder()">–û—Ç–ø—Ä–∞–≤–∏—Ç—å –≤ Telegram</button>
    <button onclick="closeCart()">–ó–∞–∫—Ä—ã—Ç—å</button>
  </div>
</div>

<button class="sticky-order-btn" onclick="openCart()">–ê—Ä–µ–Ω–¥–æ–≤–∞—Ç—å</button>

<script>
// URL –≤–∞—à–µ–π —Ç–∞–±–ª–∏—Ü—ã CSV
const sheetURL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vTOtUQAhnBMNrCPWFj0u6cjQeb0qWscrovHdCWvuBQMaCCirL4ds3i6NtjqwMpcReNsrhrY_X8ICXOL/pub?gid=2109115062&single=true&output=csv";

let products = [];
let cart = JSON.parse(localStorage.getItem('cart')) || [];
document.getElementById("cartCount").textContent = cart.length;

// --- –ó–∞–≥—Ä—É–∑–∫–∞ CSV ---
fetch(sheetURL)
  .then(r => r.text())
  .then(csv => {
    const rows = csv.split("\n").slice(1)
      .map(r => r.trim())
      .filter(r => r !== "");

    const tempProducts = rows.map(r => {
      const c = r.split(/,(?=(?:(?:[^"]*"){2})*[^"]*$)/);

      if(!c[0] || !c[1]) return null; // –∏–≥–Ω–æ—Ä–∏—Ä—É–µ–º —Å—Ç—Ä–æ–∫–∏ –±–µ–∑ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –∏–ª–∏ –Ω–∞–∑–≤–∞–Ω–∏—è

      return {
        cat: c[0].trim(),
        name: c[1].trim(),
        desc: c[2] ? c[2].replace(/"/g, '').replace(/\n/g, '|') : '–û–ø–∏—Å–∞–Ω–∏–µ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç',
        img: c[3] ? c[3].trim() : 'https://via.placeholder.com/300x180.png?text=–ù–µ—Ç+–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è',
        p1: c[4] ? Number(c[4]) : 0,
        p2: c[5] ? Number(c[5]) : 0,
        p3: c[6] ? Number(c[6]) : 0,
        p5: c[7] ? Number(c[7]) : 0,
        avail: c[8] ? c[8].trim().replace(/"/g,'').toLowerCase() === "–¥–∞" : false
      };
    }).filter(p => p !== null);

    // --- —É–±–∏—Ä–∞–µ–º –¥—É–±–ª–∏ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é ---
    const seen = new Set();
    products = tempProducts.filter(p => {
      const key = p.name.toLowerCase();
      if(seen.has(key)) return false;
      seen.add(key);
      return true;
    });

    initFilters();
    applyFilters();
  });

// --- –§–∏–ª—å—Ç—Ä—ã ---
function initFilters() {
  const f = document.getElementById("categoryFilter");
  [...new Set(products.map(p => p.cat))].forEach(cat => {
    const o = document.createElement("option");
    o.value = cat;
    o.textContent = cat;
    f.appendChild(o);
  });
}

document.getElementById("search").addEventListener("input", applyFilters);
document.getElementById("categoryFilter").addEventListener("change", applyFilters);
document.getElementById("sortPrice").addEventListener("change", applyFilters);
document.getElementById("availableOnly").addEventListener("change", applyFilters);

function applyFilters() {
  let filtered = [...products];
  const search = document.getElementById("search").value.toLowerCase();
  const cat = document.getElementById("categoryFilter").value;
  const sort = document.getElementById("sortPrice").value;
  const available = document.getElementById("availableOnly").checked;

  if(cat !== "all") filtered = filtered.filter(p => p.cat === cat);
  if(search) filtered = filtered.filter(p => p.name.toLowerCase().includes(search));
  if(available) filtered = filtered.filter(p => p.avail);

  if(sort === "asc") filtered.sort((a,b) => a.p1 - b.p1);
  if(sort === "desc") filtered.sort((a,b) => b.p1 - a.p1);

  render(filtered);
}

// --- –†–µ–Ω–¥–µ—Ä –∫–∞—Ä—Ç–æ—á–µ–∫ ---
function render(list) {
  const cont = document.getElementById("products");
  cont.innerHTML = "";
  list.forEach(i => {
    const badgeClass = i.avail ? "yes" : "no";
    const badgeText = i.avail ? "–í –Ω–∞–ª–∏—á–∏–∏" : "–ù–µ—Ç";
    const card = document.createElement("div");
    card.className = "card";
    card.innerHTML = `
      <span class="badge ${badgeClass}">${badgeText}</span>
      <img src="${i.img}" alt="${i.name}">
      <h3>${i.name}</h3>
      <div class="price">
        1 —Å—É—Ç–∫–∏: ${i.p1} ‚ÇΩ<br>
        2 —Å—É—Ç–æ–∫: ${i.p2} ‚ÇΩ<br>
        3 —Å—É—Ç–æ–∫: ${i.p3} ‚ÇΩ<br>
        –æ—Ç 5 —Å—É—Ç–æ–∫: ${i.p5} ‚ÇΩ
      </div>
      <div class="card-details"><p>${i.desc}</p></div>
      <button onclick='addCart("${i.name}",${i.p1})'>–í –∫–æ—Ä–∑–∏–Ω—É</button>
      <a href="https://t.me/ArendMSK" target="_blank"><button>–ê—Ä–µ–Ω–¥–æ–≤–∞—Ç—å</button></a>
    `;
    card.addEventListener("click", function(e){
      if(!e.target.closest("button") && !e.target.closest("a")) card.classList.toggle("open");
    });
    cont.appendChild(card);
  });
}

// --- –ö–æ—Ä–∑–∏–Ω–∞ ---
function addCart(name, price) {
  cart.push({name, price});
  localStorage.setItem('cart', JSON.stringify(cart));
  document.getElementById("cartCount").textContent = cart.length;
}
function openCart() {document.getElementById("cartBox").style.display="flex"; renderCart();}
function closeCart() {document.getElementById("cartBox").style.display="none";}
function renderCart() {
  const box = document.getElementById("cartItems");
  box.innerHTML = "";
  cart.forEach(i => {
    const d = document.createElement("div");
    d.className = "cartItem";
    d.textContent = i.name + " - " + i.price + " ‚ÇΩ";
    box.appendChild(d);
  });
}

// --- –û—Ç–ø—Ä–∞–≤–∫–∞ –∑–∞–∫–∞–∑–∞ ---
function sendOrder() {
  if(!cart.length) return alert("–ö–æ—Ä–∑–∏–Ω–∞ –ø—É—Å—Ç–∞");
  const name = document.getElementById("clientName").value.trim();
  const phone = document.getElementById("clientPhone").value.trim();
  if(!name || !phone) return alert("–í–≤–µ–¥–∏—Ç–µ –∏–º—è –∏ —Ç–µ–ª–µ—Ñ–æ–Ω");
  let text = "–ó–ê–ö–ê–ó:%0A";
  cart.forEach(i => text+=`${i.name} - ${i.price}‚ÇΩ%0A`);
  text += `–ò–º—è: ${name}%0A–¢–µ–ª–µ—Ñ–æ–Ω: ${phone}`;
  window.open("https://t.me/ArendMSK?text="+text,"_blank");
}
</script>

</body>
</html>






